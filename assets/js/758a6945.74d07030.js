"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7688],{4628:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>m,default:()=>o,frontMatter:()=>l,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"theories/Datatypes","title":"Datatypes","description":"Algebraic datatypes, known from programming languages such as ML, offer a convenient way for specifying common data structures. Records and tuples are special cases of algebraic datatypes, and so are scalars (enumeration types). But algebraic datatypes are more general. They can be used to specify finite lists, trees and other recursive structures.","source":"@site/docs-smtlib/02 - theories/05 - Datatypes.md","sourceDirName":"02 - theories","slug":"/theories/Datatypes","permalink":"/z3guide/docs/theories/Datatypes","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/z3guide/tree/main/website/docs-smtlib/02 - theories/05 - Datatypes.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Datatypes","sidebar_position":5},"sidebar":"smtlibSidebar","previous":{"title":"Arrays","permalink":"/z3guide/docs/theories/Arrays"},"next":{"title":"Strings","permalink":"/z3guide/docs/theories/Strings"}}');var t=a(4848),r=a(8453),i=a(6851);const l={title:"Datatypes",sidebar_position:5},m=void 0,c={},h=[{value:"Records",id:"records",level:3},{value:"Record Updates",id:"record-updates",level:3},{value:"Scalars (enumeration types)",id:"scalars-enumeration-types",level:3},{value:"Recursive datatypes",id:"recursive-datatypes",level:3},{value:"Mutually recursive datatypes",id:"mutually-recursive-datatypes",level:3},{value:"Z3 will not prove inductive facts",id:"z3-will-not-prove-inductive-facts",level:3},{value:"Nested datatypes with Arrays and Sequences",id:"nested-datatypes-with-arrays-and-sequences",level:3},{value:"Using Datatypes for solving type constraints",id:"using-datatypes-for-solving-type-constraints",level:2},{value:"Checking if terms have principal types",id:"checking-if-terms-have-principal-types",level:4},{value:"Using UNSAT cores to identify mutually inconsistent type constraints",id:"using-unsat-cores-to-identify-mutually-inconsistent-type-constraints",level:3},{value:"Using optimization to localize type errors",id:"using-optimization-to-localize-type-errors",level:3}];function d(s){const e={annotation:"annotation",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",math:"math",mi:"mi",mo:"mo",mrow:"mrow",msup:"msup",mtext:"mtext",p:"p",semantics:"semantics",span:"span",ul:"ul",...(0,r.R)(),...s.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:"Algebraic datatypes, known from programming languages such as ML, offer a convenient way for specifying common data structures. Records and tuples are special cases of algebraic datatypes, and so are scalars (enumeration types). But algebraic datatypes are more general. They can be used to specify finite lists, trees and other recursive structures."}),"\n",(0,t.jsx)(e.h3,{id:"records",children:"Records"}),"\n",(0,t.jsx)(e.p,{children:"A record is specified as a datatype with a single constructor and as many arguments as record elements. The number of arguments to a record are always the same. The type system does not allow to extend records and there is no record subtyping."}),"\n",(0,t.jsx)(e.p,{children:"The following example illustrates that two records are equal only if all the arguments are equal. It introduces the parametric type Pair, with constructor mk-pair and two arguments that can be accessed using the selector functions first and second."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-datatypes (T1 T2) ((Pair (mk-pair (first T1) (second T2)))))\\n(declare-const p1 (Pair Int Int))\\n(declare-const p2 (Pair Int Int))\\n(assert (= p1 p2))\\n(assert (< (second p1) 20))\\n(check-sat)\\n(get-model)\\n(assert (not (= (first p1) (first p2))))\\n(check-sat)","result":{"output":"sat\\n(\\n  (define-fun p2 () (Pair Int Int)\\n    (mk-pair 0 19))\\n  (define-fun p1 () (Pair Int Int)\\n    (mk-pair 0 19))\\n)\\nunsat\\n","error":"","status":"z3-ran","hash":"0b97f17f47b76dc8d68c5426933ded7b5ba090ed"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.h3,{id:"record-updates",children:"Record Updates"}),"\n",(0,t.jsx)(e.p,{children:"You can create variants of records by updating selected fields."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-datatypes (T1 T2) ((Pair (mk-pair (first T1) (second T2)))))\\n(declare-const p1 (Pair Int Int))\\n(declare-const p2 (Pair Int Int))\\n(assert (not (= p1 p2)))\\n(assert (= p1 ((_ update-field first) p2 1)))\\n(check-sat)\\n(get-model)","result":{"output":"sat\\n(\\n  (define-fun p2 () (Pair Int Int)\\n    (mk-pair 2 3))\\n  (define-fun p1 () (Pair Int Int)\\n    (mk-pair 1 3))\\n)\\n","error":"","status":"z3-ran","hash":"6679b34c0c57ca37d68d20b148559e02a3beeb1d"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.p,{children:"The update-field function is not part of the SMTLIB standard. Z3 assumes the following semantics:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Given ",(0,t.jsx)(e.code,{children:"y := ((_ update-field acc) x value)"})]}),"\n",(0,t.jsxs)(e.li,{children:["The field is an accessor function from one of the constructors of the datatype associated with ",(0,t.jsx)(e.code,{children:"x"}),"."]}),"\n",(0,t.jsxs)(e.li,{children:["If ",(0,t.jsx)(e.code,{children:"x"})," was constructed using the constructor that defines accessor ",(0,t.jsx)(e.code,{children:"acc"}),", then only the field associated with ",(0,t.jsx)(e.code,{children:"acc"})," is updated (to value)."]}),"\n",(0,t.jsxs)(e.li,{children:["If ",(0,t.jsx)(e.code,{children:"x"})," was not constructed using the constructor that defines accessor ",(0,t.jsx)(e.code,{children:"acc"}),", then ",(0,t.jsx)(e.code,{children:"y"})," is equal to ",(0,t.jsx)(e.code,{children:"x"}),"."]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"scalars-enumeration-types",children:"Scalars (enumeration types)"}),"\n",(0,t.jsx)(e.p,{children:"A scalar sort is a finite domain sort. The elements of the finite domain are enumerated as distinct constants. For example, the sort S is a scalar type with three values A, B and C. It is possible for three constants of sort S to be distinct, but not for four constants."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-datatypes () ((S A B C)))\\n(declare-const x S)\\n(declare-const y S)\\n(declare-const z S)\\n(declare-const u S)\\n(assert (distinct x y z))\\n(check-sat)\\n(assert (distinct x y z u))\\n(check-sat)","result":{"output":"sat\\nunsat\\n","error":"","status":"z3-ran","hash":"d4939fa38d58838555bdf337bc0690ad54d6f654"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.h3,{id:"recursive-datatypes",children:"Recursive datatypes"}),"\n",(0,t.jsx)(e.p,{children:"A recursive datatype declaration includes itself directly (or indirectly) as a component. A standard example of a recursive data-type is the one of lists. A parametric list can be specified in Z3 as"}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-datatypes (T) ((Lst nil (cons (hd T) (tl Lst)))))\\n(declare-const l1 (Lst Int))\\n(declare-const l2 (Lst Bool))","result":{"output":"","error":"","status":"z3-ran","hash":"d0afa7e26e0cdcb3260d07873419885a411b45ca"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.p,{children:"The List recursive datatype is builtin in Z3. The empty list is nil, and the constructor insert is used to build new lists. The accessors head and tail are defined as usual."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-const l1 (List Int))\\n(declare-const l2 (List Int))\\n(declare-const l3 (List Int))\\n(declare-const x Int)\\n(assert (not (= l1 nil)))\\n(assert (not (= l2 nil)))\\n(assert (= (head l1) (head l2)))\\n(assert (not (= l1 l2)))\\n(assert (= l3 (insert x l2)))\\n(assert (< x 100))\\n(check-sat)\\n(get-model)\\n(assert (= (tail l1) (tail l2)))\\n(check-sat)","result":{"output":"sat\\n(\\n  (define-fun l1 () (List Int)\\n    (insert 2 nil))\\n  (define-fun x () Int\\n    99)\\n  (define-fun l2 () (List Int)\\n    (insert 2 (insert 3 nil)))\\n  (define-fun l3 () (List Int)\\n    (insert 99 (insert 2 (insert 3 nil))))\\n)\\nunsat\\n","error":"","status":"z3-ran","hash":"0ce9ad95b2b0f73abac8289464347ea7a9134c29"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.p,{children:"In the example above, we also assert that l1 and l2 are not nil. This is because the interpretation of head and tail is under-specified on nil. So then head and tail would not be able to distinguish nil from (insert (head nil) (tail nil))."}),"\n",(0,t.jsx)(e.h3,{id:"mutually-recursive-datatypes",children:"Mutually recursive datatypes"}),"\n",(0,t.jsx)(e.p,{children:"You can also specify mutually recursive datatypes for Z3. We list one example below."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"; declare a mutually recursive parametric datatype\\n(declare-datatypes (T) ((Tree leaf (node (value T) (children TreeList)))\\n                        (TreeList nil (cons (car Tree) (cdr TreeList)))))\\n(declare-const t1 (Tree Int))\\n(declare-const t2 (Tree Bool))\\n; we must use the \'as\' construct to distinguish the leaf (Tree Int) from leaf (Tree Bool)\\n(assert (not (= t1 (as leaf (Tree Int)))))\\n(assert (< (value t1) 20))\\n(assert (not (is-leaf t2)))\\n(assert (not (value t2)))\\n(check-sat)\\n(get-model)","result":{"output":"sat\\n(\\n  (define-fun t2 () (Tree Bool)\\n    (node false (as nil (TreeList Bool))))\\n  (define-fun t1 () (Tree Int)\\n    (node 0 (as nil (TreeList Int))))\\n)\\n","error":"","status":"z3-ran","hash":"8d6ddd09baa3aa9fce5f2274a22fc9fda97243dc"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.p,{children:"In the example above, we have a tree of Booleans and a tree of integers. The leaf constant must return a tree of a specific sort. To specify the result sort, we use the qualified identifier (as leaf (Tree Int)). Note that, we do not need to use a qualified identifier for value, since Z3 can infer the intended declaration using the sort of the argument."}),"\n",(0,t.jsx)(e.h3,{id:"z3-will-not-prove-inductive-facts",children:"Z3 will not prove inductive facts"}),"\n",(0,t.jsx)(e.p,{children:"The ground decision procedures for recursive datatypes don't lift to establishing inductive facts. Z3 does not contain methods for producing proofs by induction. This may change in the future. In particular, consider the following example where the function p is true on all natural numbers, which can be proved by induction over Nat. Z3 enters a matching loop as it attempts instantiating the universally quantified implication."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(set-option :timeout 2000)\\n(declare-datatypes () ((Nat zero (succ (pred Nat)))))\\n(declare-fun p (Nat) Bool)\\n(assert (p zero))\\n(assert (forall ((x Nat)) (implies (p (pred x)) (p x))))\\n(assert (not (forall ((x Nat)) (p x))))\\n(check-sat)\\n(get-info :all-statistics)","result":{"output":"unknown\\n(:added-eqs               24417\\n :binary-propagations     1\\n :conflicts               3488\\n :datatype-accessor-ax    3489\\n :datatype-constructor-ax 6976\\n :datatype-occurs-check   6978\\n :datatype-splits         3489\\n :decisions               3488\\n :final-checks            3489\\n :max-generation          1\\n :max-memory              18.18\\n :memory                  10.39\\n :mk-bool-var             10469\\n :mk-clause-binary        1\\n :num-allocs              88622\\n :num-checks              1\\n :propagations            1\\n :quant-instantiations    3488\\n :rlimit-count            286467\\n :time                    2.10)\\n","error":"","status":"z3-ran","hash":"bf661d08e86fab7bb39f34e4ed611772b7bdf3c2"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.h3,{id:"nested-datatypes-with-arrays-and-sequences",children:"Nested datatypes with Arrays and Sequences"}),"\n",(0,t.jsx)(e.p,{children:"In some applications it is convenient to have a sequence of types that are\nrecursively defined. For example an abstract syntax tree of a program is a sequence of\nbasic statements, and a basic statement can be an assignment or an if-then-else statement,\nwhere the then and else branches are statements. Similarly, it may be convenient to use\na nesting of algebraic data-types and arrays. Z3 supports nesting ADTs over sequences and over\nranges of arrays."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-sort Expr)\\n(declare-sort Var)\\n(declare-datatypes ((Stmt 0)) \\n  (((Assignment (lval Var) (rval Expr)) \\n    (If (cond Expr) (th Stmt) (el Stmt)) \\n    (Seq (stmts (Seq Stmt))))))\\n\\n(declare-const s Stmt)\\n(declare-const t Stmt)\\n\\n(assert ((_ is Seq) t))\\n(assert ((_ is Seq) s))\\n(assert (= s (seq.nth (stmts t) 2)))\\n(assert (>= (seq.len (stmts s)) 5))\\n(check-sat)\\n(get-model)\\n(assert (= s (Seq (seq.unit s))))\\n(check-sat)","result":{"output":"sat\\n(\\n  (define-fun t () Stmt\\n    (Seq (as seq.empty (Seq Stmt))))\\n  (define-fun s () Stmt\\n    (Seq (seq.++ (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n             (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n             (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n             (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n             (seq.unit (Seq (as seq.empty (Seq Stmt)))))))\\n  (define-fun seq.nth_u ((x!0 (Seq Stmt)) (x!1 Int)) Stmt\\n    (Seq (seq.++ (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n                 (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n                 (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n                 (seq.unit (Seq (as seq.empty (Seq Stmt))))\\n                 (seq.unit (Seq (as seq.empty (Seq Stmt)))))))\\n)\\nunsat\\n","error":"","status":"z3-ran","hash":"580490893b60c871648a021222c0322c8d6a4127"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.h2,{id:"using-datatypes-for-solving-type-constraints",children:"Using Datatypes for solving type constraints"}),"\n",(0,t.jsx)(e.p,{children:"In the following we use algebraic datatypes to represent type constraints\nfor simply typed lambda calculus.\nTerms and types over simply typed lambda calculus are of the form"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mo,{children:"\u2223"}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{children:"\u2223"}),(0,t.jsx)(e.mi,{children:"\u03bb"}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mtext,{children:"\xa0"}),(0,t.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,t.jsx)(e.mtext,{children:"\xa0"}),(0,t.jsx)(e.mi,{children:"M"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"M ::= x \\mid M M \\mid \\lambda x \\ . \\ M"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"::="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2223"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"MM"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2223"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"\u03bb"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mspace",children:"\xa0"}),(0,t.jsx)(e.span,{className:"mord",children:"."}),(0,t.jsx)(e.span,{className:"mspace",children:"\xa0"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"})]})]})]})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"i"}),(0,t.jsx)(e.mi,{children:"n"}),(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mo,{children:"\u2223"}),(0,t.jsx)(e.mi,{children:"s"}),(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"r"}),(0,t.jsx)(e.mi,{children:"i"}),(0,t.jsx)(e.mi,{children:"n"}),(0,t.jsx)(e.mi,{children:"g"}),(0,t.jsx)(e.mo,{children:"\u2223"}),(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{children:"\u2192"}),(0,t.jsx)(e.mi,{children:"\u03c4"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\tau ::= int \\mid string \\mid \\tau \\rightarrow \\tau"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"::="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2223"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2223"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2192"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"})]})]})]})}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["where ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"x"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})})]})," is bound variable, ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"M M'"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})})]})," applies the function ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"M"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"M"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"})]})})]})," to argument ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"M'"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})})]}),", and ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"\u03bb"}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mtext,{children:"\xa0"}),(0,t.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,t.jsx)(e.mtext,{children:"\xa0"}),(0,t.jsx)(e.mi,{children:"M"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\lambda x \\ . \\ M"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"\u03bb"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mspace",children:"\xa0"}),(0,t.jsx)(e.span,{className:"mord",children:"."}),(0,t.jsx)(e.span,{className:"mspace",children:"\xa0"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"})]})})]})," is a lambda abstraction.\nThe ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"i"}),(0,t.jsx)(e.mi,{children:"n"}),(0,t.jsx)(e.mi,{children:"t"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"int"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6595em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})})]})," and ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"s"}),(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"r"}),(0,t.jsx)(e.mi,{children:"i"}),(0,t.jsx)(e.mi,{children:"n"}),(0,t.jsx)(e.mi,{children:"g"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"string"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.854em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"})]})})]})," types are type constants."]}),"\n",(0,t.jsx)(e.p,{children:"A type judgemnt is"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"}),(0,t.jsx)(e.mo,{children:"\u22a2"}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"\u03c4"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma \\vdash M : \\tau"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u22a2"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"})]})]})]})}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["where ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"})]})})]})," is a type environment that provides types to free variables in ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"M"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"M"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"})]})})]}),".\nAn expression ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"M"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"M"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"})]})})]})," has a type ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"\u03c4"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\tau"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"})]})})]})," if there is a derivation using the rules:"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{children:"\u22a2"}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"\u03c4"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma, x : \\tau \\vdash x : \\tau"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u22a2"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"})]})]})]})}),"\n",(0,t.jsxs)(e.li,{children:["If ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"}),(0,t.jsx)(e.mo,{children:"\u22a2"}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{children:"\u2192"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma \\vdash M : \\tau \\rightarrow \\tau'"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u22a2"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2192"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})]})]}),", ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"}),(0,t.jsx)(e.mo,{children:"\u22a2"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"\u03c4"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma \\vdash M' : \\tau"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u22a2"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"})]})]})]})," then ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"}),(0,t.jsx)(e.mo,{children:"\u22a2"}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma \\vdash M M' : \\tau'"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u22a2"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})]})]}),"."]}),"\n",(0,t.jsxs)(e.li,{children:["If ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{children:"\u22a2"}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma, x : \\tau \\vdash M : \\tau'"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u22a2"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})]})]})," then ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"}),(0,t.jsx)(e.mo,{children:"\u22a2"}),(0,t.jsx)(e.mi,{children:"\u03bb"}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{children:":"}),(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{children:"\u2192"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"\u03c4"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma \\vdash \\lambda x : M : \\tau \\rightarrow \\tau'"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u22a2"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"\u03bb"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:":"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2192"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.7519em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.1132em"},children:"\u03c4"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})]})]}),"."]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"We can use constraints over algebraic data-types to determine if expressions can be typed."}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"y"}),(0,t.jsx)(e.mi,{children:"p"}),(0,t.jsx)(e.mi,{children:"e"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"Y"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"type(M M') = Y"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.0019em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"Y"})]})]})]}),",  ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"y"}),(0,t.jsx)(e.mi,{children:"p"}),(0,t.jsx)(e.mi,{children:"e"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"X"}),(0,t.jsx)(e.mo,{children:"\u2192"}),(0,t.jsx)(e.mi,{children:"Y"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"type(M) = X \\rightarrow Y"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2192"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"Y"})]})]})]}),", ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"y"}),(0,t.jsx)(e.mi,{children:"p"}),(0,t.jsx)(e.mi,{children:"e"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"X"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"type(M') = X"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.0019em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.7519em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"})]})]})]}),", for fresh ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"X"}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsx)(e.mi,{children:"Y"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"X, Y"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"Y"})]})})]}),"."]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"y"}),(0,t.jsx)(e.mi,{children:"p"}),(0,t.jsx)(e.mi,{children:"e"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"\u03bb"}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"y"}),(0,t.jsx)(e.mi,{children:"p"}),(0,t.jsx)(e.mi,{children:"e"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"x"}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsx)(e.mo,{children:"\u2192"}),(0,t.jsx)(e.mi,{children:"t"}),(0,t.jsx)(e.mi,{children:"y"}),(0,t.jsx)(e.mi,{children:"p"}),(0,t.jsx)(e.mi,{children:"e"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"M"}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"type(\\lambda x . M) = type(x) \\rightarrow type(M)"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"\u03bb"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mord",children:"."}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"\u2192"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,t.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n"]}),"\n",(0,t.jsx)(e.h4,{id:"checking-if-terms-have-principal-types",children:"Checking if terms have principal types"}),"\n",(0,t.jsx)(e.p,{children:"We define types and expressions as algebraic data-types.\nThe types of applications produces three constraints for\napplications and the single constraint for lambda abstraction.\nThe encoding into SMTLIB uses several features. Besides algebraic\ndata-types it uses uninterpreted functions instead of introducing\nfresh variables. It defines a recursive function that extracts\ntype constraints from an expression."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-datatypes () ((Type \\n  int \\n  string \\n  (arrow (dom Type) (rng Type)))))\\n(declare-sort Var)\\n(declare-datatypes () ((M \\n  (lam (bound Var) (body M)) \\n  (var (v Var)) \\n  (app (fn M) (arg M)))))\\n(declare-fun type (M) Type)\\n(define-fun dom ((M M)) Type (dom (type M)))\\n(define-fun rng ((M M)) Type (rng (type M)))\\n(define-fun type ((x Var)) Type (type (var x)))\\n(declare-const x Var)\\n(declare-const y Var)\\n(define-fun app-constraint ((M1 M) (M2 M)) Bool\\n  (and (= (dom M1) (type M2))\\n       (is-arrow (type M1))\\n       (= (type (app M1 M2)) (rng M1)))\\n)\\n(define-fun lam-constraint ((x Var) (M M)) Bool\\n  (= (type (lam x M)) (arrow (type x) (type M)))\\n)\\n\\n(define-fun-rec type-constraints ((M M)) Bool\\n    (match M\\n     (case (var x) true)\\n     (case (app M1 M2)\\n         (if (app-constraint M1 M2)\\n             (and (type-constraints M1) (type-constraints M2)) \\n             false))\\n     (case (lam x M1)\\n         (if (lam-constraint x M1)\\n             (type-constraints M1) \\n             false))\\n    )\\n)\\n\\n; the identity function can be typed.\\n(push)\\n(assert (type-constraints (lam x (var x))))\\n(check-sat)\\n(pop)\\n\\n; there is no simple type for x such that (x x) is well typed.\\n; the type constraints are unsat due to the semantics of algebraic\\n; data-types: it is not possible to create an instance of an\\n; algebraic data-type that is a sub-term of itself.\\n(push)\\n(assert (type-constraints (lam x (app (var x) (var x)))))\\n(check-sat)\\n(pop)\\n\\n; Applying a function that takes an integer to a string is not well-typed\\n(push)\\n(declare-const plus M)\\n(assert (= (type plus) (arrow int (arrow int int))))\\n(declare-fun ofint (Int) M)\\n(assert (= (type (ofint 3)) int))\\n(declare-fun ofstring (String) M)\\n(assert (= (type (ofstring \\"a\\")) string))\\n(assert (type-constraints (app (lam x (app (app plus (var x)) (ofint 3))) (ofstring \\"a\\"))))\\n(check-sat)\\n(pop)","result":{"output":"sat\\nunsat\\nunsat\\n","error":"","status":"z3-ran","hash":"4cd616fa089121545b8416a54980925ecf366b18"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.h3,{id:"using-unsat-cores-to-identify-mutually-inconsistent-type-constraints",children:"Using UNSAT cores to identify mutually inconsistent type constraints"}),"\n",(0,t.jsx)(e.p,{children:"We can track each sub-expression and use unsatisfiable cores to\nidentify a set of mutually inconsistent type constraints.\nWhen the core is minimial, it means that modifying any one of the\nsubterms from the corresponding violated constraints can fix the type error. This provides some indication of error location, but isn't\ngreat for diagnostics. In the next section we use MaxSAT for more\ntargeted diagnostics."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(set-option :produce-unsat-cores true)\\n(set-option :smt.core.minimize true)\\n(declare-datatypes () ((Type \\n  int \\n  string \\n  (arrow (dom Type) (rng Type)))))\\n(declare-sort Var)\\n(declare-datatypes () ((M \\n  (lam (bound Var) (body M)) \\n  (var (v Var)) \\n  (app (fn M) (arg M)))))\\n(declare-fun type (M) Type)\\n(declare-const x Var)\\n(declare-const y Var)\\n(define-fun dom ((M M)) Type (dom (type M)))\\n(define-fun rng ((M M)) Type (rng (type M)))\\n(define-fun type ((x Var)) Type (type (var x)))\\n(define-fun app-constraint ((M1 M) (M2 M)) Bool\\n  (and (= (dom M1) (type M2))\\n       (is-arrow (type M1))\\n       (= (type (app M1 M2)) (rng M1))\\n  )\\n)\\n(define-fun lam-constraint ((x Var) (M M)) Bool\\n  (= (type (lam x M)) (arrow (type x) (type M)))\\n)\\n\\n(declare-const plus M)\\n(assert (= (type plus) (arrow int (arrow int int))))\\n(declare-fun ofint (Int) M)\\n(declare-fun ofstring (String) M)\\n(define-const x_plus_3 M (app (app plus (var x)) (ofint 3)))\\n\\n(assert (= (type (ofint 3)) int))\\n(assert (= (type (ofstring \\"a\\")) string))\\n\\n(assert (! (app-constraint (lam x x_plus_3) (ofstring \\"a\\")) :named t1))\\n(assert (! (lam-constraint x x_plus_3)                      :named t2))\\n(assert (! (app-constraint (app plus (var x)) (ofint 3))    :named t3))\\n(assert (! (app-constraint plus (var x))                    :named t4))\\n(check-sat)\\n(get-unsat-core)","result":{"output":"unsat\\n(t4 t2 t1)\\n","error":"","status":"z3-ran","hash":"15919629a5010b652828d5598ca36bdaa9e62752"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'}),"\n",(0,t.jsx)(e.h3,{id:"using-optimization-to-localize-type-errors",children:"Using optimization to localize type errors"}),"\n",(0,t.jsx)(e.p,{children:"By asserting each type checking condition as a soft constraint and seeking an optimized solution to satisfy as many type constraints as possible, we obtain targeted information of what sub-terms could not\nbe type checked."}),"\n",(0,t.jsx)(e.p,{children:"We can read off the type annotations for remaining sub-terms using\nthe current model. Albeit, it is not a user-friendly format."}),"\n",(0,t.jsx)(i.A,{input:'{"lang":"z3","highlight":"clojure","statusCodes":{"success":"z3-ran","timeout":"z3-timed-out","runError":"z3-failed","runtimeError":"z3-runtime-error"},"code":"(declare-datatypes () ((Type \\n  int \\n  string \\n  (arrow (dom Type) (rng Type)))))\\n(declare-sort Var)\\n(declare-datatypes () ((M \\n  (lam (bound Var) (body M)) \\n  (var (v Var)) \\n  (app (fn M) (arg M)))))\\n(declare-fun type (M) Type)\\n(declare-const x Var)\\n(declare-const y Var)\\n(define-fun dom ((M M)) Type (dom (type M)))\\n(define-fun rng ((M M)) Type (rng (type M)))\\n(define-fun type ((x Var)) Type (type (var x)))\\n(define-fun app-constraint ((M1 M) (M2 M)) Bool\\n  (and (= (dom M1) (type M2))\\n          (is-arrow (type M1))\\n          (= (type (app M1 M2)) (rng M1))\\n  )\\n)\\n(define-fun lam-constraint ((x Var) (M M)) Bool\\n  (= (type (lam x M)) (arrow (type x) (type M)))\\n)\\n\\n(declare-const plus M)\\n(assert (= (type plus) (arrow int (arrow int int))))\\n(declare-fun ofint (Int) M)\\n(assert (= (type (ofint 3)) int))\\n(declare-fun ofstring (String) M)\\n(declare-const t1 Bool)\\n(declare-const t2 Bool)\\n(declare-const t3 Bool)\\n(declare-const t4 Bool)\\n(assert (= (type (ofstring \\"a\\")) string))\\n(define-const x_plus_3 M (app (app plus (var x)) (ofint 3)))\\n(assert (= t1 (app-constraint (lam x x_plus_3) (ofstring \\"a\\"))))\\n(assert (= t2 (lam-constraint x x_plus_3)))\\n(assert (= t3 (app-constraint (app plus (var x)) (ofint 3))))\\n(assert (= t4 (app-constraint plus (var x))))\\n(assert-soft t1)\\n(assert-soft t2)\\n(assert-soft t3)\\n(assert-soft t4)\\n(check-sat)\\n(get-objectives)\\n(get-value (t1 t2 t3 t4))\\n(get-model)","result":{"output":"sat\\n(objectives\\n ( 1)\\n)\\n((t1 false)\\n (t2 true)\\n (t3 true)\\n (t4 true))\\n(\\n  ;; universe for Var:\\n  ;;   Var!val!2 Var!val!0 Var!val!3 Var!val!1 \\n  ;; -----------\\n  ;; definitions for universe elements:\\n  (declare-fun Var!val!2 () Var)\\n  (declare-fun Var!val!0 () Var)\\n  (declare-fun Var!val!3 () Var)\\n  (declare-fun Var!val!1 () Var)\\n  ;; cardinality constraint:\\n  (forall ((x Var))\\n          (or (= x Var!val!2) (= x Var!val!0) (= x Var!val!3) (= x Var!val!1)))\\n  ;; -----------\\n  (define-fun x () Var\\n    Var!val!0)\\n  (define-fun plus () M\\n    (var Var!val!3))\\n  (define-fun x_plus_3 () M\\n    (app (app plus (var x)) (ofint 3)))\\n  (define-fun t3 () Bool\\n    true)\\n  (define-fun t4 () Bool\\n    true)\\n  (define-fun t1 () Bool\\n    false)\\n  (define-fun t2 () Bool\\n    true)\\n  (define-fun y () Var\\n    Var!val!2)\\n  (define-fun type ((x!0 M)) Type\\n    (ite (= x!0 (var Var!val!3)) (arrow int (arrow int int))\\n    (ite (= x!0 (var Var!val!1)) string\\n    (ite (= x!0\\n            (lam Var!val!0\\n                 (app (app (var Var!val!3) (var Var!val!0)) (var Var!val!2))))\\n      (arrow int int)\\n    (ite (= x!0 (app (var Var!val!3) (var Var!val!0))) (arrow int int)\\n      int)))))\\n  (define-fun ofint ((x!0 Int)) M\\n    (var Var!val!2))\\n  (define-fun ofstring ((x!0 String)) M\\n    (var Var!val!1))\\n)\\n","error":"","status":"z3-ran","hash":"e419afab24edaff99ef61b7b33a87b543da42331"},"githubRepo":"Z3Prover/z3","editable":false,"readonly":false,"showLineNumbers":true,"langVersion":"4.15.1","tool":"z3-solver"}'})]})}function o(s={}){const{wrapper:e}={...(0,r.R)(),...s.components};return e?(0,t.jsx)(e,{...s,children:(0,t.jsx)(d,{...s})}):d(s)}}}]);